<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><base href="/artaza/"/><meta name="next-head-count" content="3"/><link rel="preload" href="/artaza/_next/static/css/a8aaa73d44825a3e.css" as="style"/><link rel="stylesheet" href="/artaza/_next/static/css/a8aaa73d44825a3e.css" data-n-g=""/><link rel="preload" href="/artaza/_next/static/css/6dd7d3f6137128d3.css" as="style"/><link rel="stylesheet" href="/artaza/_next/static/css/6dd7d3f6137128d3.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/artaza/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/artaza/_next/static/chunks/webpack-61f00bc22cf6dd46.js" defer=""></script><script src="/artaza/_next/static/chunks/framework-3b5a00d5d7e8d93b.js" defer=""></script><script src="/artaza/_next/static/chunks/main-97dc0a10f0946b99.js" defer=""></script><script src="/artaza/_next/static/chunks/pages/_app-846fbf2e5201bc3a.js" defer=""></script><script src="/artaza/_next/static/chunks/320-c48721dfd7d228ec.js" defer=""></script><script src="/artaza/_next/static/chunks/pages/blog/%5Bslug%5D-8cdb00ce5077db69.js" defer=""></script><script src="/artaza/_next/static/KqNw35PVLh9vIlnzlwBop/_buildManifest.js" defer=""></script><script src="/artaza/_next/static/KqNw35PVLh9vIlnzlwBop/_ssgManifest.js" defer=""></script></head><body><div id="__next"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/default.min.css"/><main class="__className_198ee5"><div class="blog_blog_page_wrapper__FyeSS"><div class="blog_blog_page__Dpz4Y"><div class="blog_post_info__RFq7N"><img src="./graphics/cmake_wasm.png" alt="blog page cover" class="blog_cover_image__ijGpS"/><h1 class="blog_title__dLTYQ">Compile C++ to wasm using CMake</h1><div class="blog_date__YKU3Y">October 10, 2022</div><div class="blog_tags__1olfU"><span> <!-- -->web<!-- --> </span><span> <!-- -->c++<!-- --> </span><span> <!-- -->wasm<!-- --> </span></div></div><div class="blog_post_content__VVCpL"><h1 id="introduction">Introduction</h1>
<p>In this article, we will talk about, how to setup a <strong>CMake</strong> to compile a C++ project to <strong>WebAssembly (.wasm).</strong></p>
<h2 id="installation-prerequisite">Installation Prerequisite</h2>
<ul>
<li>Emscripten <a href="https://emscripten.org/docs/getting_started/downloads.html">(Click here)</a></li>
<li>CMake <a href="https://cmake.org/download/">(Click here)</a></li>
</ul>
<h2 id="file-structure">File Structure</h2>
<ul>
<li>ðŸ“‚build</li>
<li>ðŸ“‚cpp</li>
<li>ðŸ“‚generated</li>
</ul>
<h2 id="creating-c-file">Creating C++ file</h2>
<pre><code class="language-c++"><span class="hljs-comment">// cpp/main.cpp</span>

<span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span> {
    <span class="hljs-function"><span class="hljs-type">char</span>* <span class="hljs-title">greet</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello &quot;</span>;
    }
}
</code></pre>
<h2 id="creating-the-cmakeliststxt-file">Creating the <code>CMakeLists.txt</code> file</h2>
<pre><code class="language-python">project(Wasm) <span class="hljs-comment"># PROJECT NAME</span>
cmake_minimum_required(VERSION <span class="hljs-number">3.16</span><span class="hljs-number">.3</span>)

<span class="hljs-built_in">set</span>(CMAKE_RUNTIME_OUTPUT_DIRECTORY <span class="hljs-string">&quot;${CMAKE_SOURCE_DIR}/../generated&quot;</span>)
<span class="hljs-built_in">set</span>(EXPORTED_FUNCTIONS <span class="hljs-string">&quot;&#x27;[_greet]&#x27;&quot;</span>) <span class="hljs-comment"># Putting the greet function we want to export</span>
<span class="hljs-built_in">set</span>(CMAKE_EXECUTABLE_SUFFIX <span class="hljs-string">&quot;.js&quot;</span>)
<span class="hljs-built_in">set</span>(CMAKE_BUILD_RPATH <span class="hljs-string">&quot;/build&quot;</span>)
<span class="hljs-built_in">set</span>(CMAKE_CXX_STANDARD <span class="hljs-number">17</span>)

include_directories(include)
file(GLOB SOURCES src/*.cpp)
add_executable(compiled ${SOURCES})

set_target_properties(compiled PROPERTIES LINK_FLAGS <span class="hljs-string">&quot;-O3 -s WASM=0 -s EXPORTED_FUNCTIONS=${EXPORTED_FUNCTIONS}&quot;</span>)
</code></pre>
</div></div></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"Compile C++ to wasm using CMake","date":"October 10, 2022","description":"As you know useEffect is used in React Components for running code on state changes on states and componenet reloads. But, useEffect() functionis asynchronous which poses problems in some particular situations. But, useLayoutEffect() works like class components life cycle methods which has advantages","tags":["web","c++","wasm"],"cover_image":"./graphics/cmake_wasm.png"},"content":"\n# Introduction\n\nIn this article, we will talk about, how to setup a **CMake** to compile a C++ project to **WebAssembly (.wasm).**\n\n## Installation Prerequisite\n\n- Emscripten [(Click here)](https://emscripten.org/docs/getting_started/downloads.html)\n- CMake [(Click here)](https://cmake.org/download/)\n\n## File Structure\n\n- ðŸ“‚build\n- ðŸ“‚cpp\n- ðŸ“‚generated\n\n## Creating C++ file\n\n```c++\n// cpp/main.cpp\n\nextern \"C\" {\n\tchar* greet(){\n\t\treturn \"Hello \";\n\t}\n}\n\n```\n\n## Creating the `CMakeLists.txt` file\n\n```python\nproject(Wasm) # PROJECT NAME\ncmake_minimum_required(VERSION 3.16.3)\n\nset(CMAKE_RUNTIME_OUTPUT_DIRECTORY \"${CMAKE_SOURCE_DIR}/../generated\")\nset(EXPORTED_FUNCTIONS \"'[_greet]'\") # Putting the greet function we want to export\nset(CMAKE_EXECUTABLE_SUFFIX \".js\")\nset(CMAKE_BUILD_RPATH \"/build\")\nset(CMAKE_CXX_STANDARD 17)\n\ninclude_directories(include)\nfile(GLOB SOURCES src/*.cpp)\nadd_executable(compiled ${SOURCES})\n\nset_target_properties(compiled PROPERTIES LINK_FLAGS \"-O3 -s WASM=0 -s EXPORTED_FUNCTIONS=${EXPORTED_FUNCTIONS}\")\n```\n","slug":"cpp-to-wasm-using-cmake"},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"cpp-to-wasm-using-cmake"},"buildId":"KqNw35PVLh9vIlnzlwBop","assetPrefix":"/artaza","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>